---
title: "Pyramid Scheme"
description: "í”„ë¡œê·¸ëž˜ë¨¸ìŠ¤ ë‹¤ë‹¨ê³„ íŒë§¤"
createdAt: "2025-03-19"
path: ["algorithms", "tree"]
tags:
  pattern: "tree"
  category: "tree"
  platform: "programmers"
---

> ðŸ“Œ **Source Code:** [tree/prg2-pyramidscheme.js](https://github.com/0teklee/pattern-recognition/tree/main/site/content/algorithms/tree/prg2-pyramidscheme.js)

```js
function solution(enroll, referral, seller, amount) {
  const sellerMap = new Map();
  const price = 100;
  let result = [];
  for (let member of enroll) {
    sellerMap.set(`${member}`, { income: 0, shared: "" });
  }

  for (let i = 0; i < referral.length; i++) {
    // ìžì‹ ì„ ë“±ë¡í•œ ì‚¬ëžŒë§Œ ê¸°ì–µí•˜ë©´ ë¨
    if (referral[i] !== "-") {
      const enrolledBy = sellerMap.get(`${enroll[i]}`);

      sellerMap.set(enroll[i], { ...enrolledBy, shared: referral[i] });
      // ìžì‹ ì„ ë“±ë¡í•œ ì‚¬ëžŒì—ê²Œ ì´ìµê¸ˆ ê³„ì‚°ì—ì„œ ìžì‹ ì˜ ì´ìµê¸ˆì„ ë¹¼ì„œ ë”í•´ì¤Œ.
      console.log(
        `${enroll[i]} \n enrolledBy : ${referral[i]} / ${enroll[i]} data: ${JSON.stringify(sellerMap.get(`${enroll[i]}`))}`,
      );
    }
    // ì¶”ê°€ë¡œ ì¶”ì²œì„ ë°›ì€ ì‚¬ëžŒ enroll[i]ëŠ”
  }

  // ì—¬ê¸°ì„œ ì´ìµ ê³„ì‚°í•¨
  for (let i = 0; i < seller.length; i++) {
    const salesman = sellerMap.get(seller[i]);
    if (!salesman) {
      continue;
    }
    console.log(`${i} - salesman : ${seller[i]}`, salesman);
    const refer = salesman.shared;
    const salesCount = amount[i];
    console.log(`${i} - salesCount`, salesCount);
    let fee = 0;

    const income = salesCount * price;
    if (refer) {
      fee = income / 10;
    }
    const netIncome = income - fee;
    console.log(
      `${i} income: ${income}\n fee: ${fee} \nnetIncome >> \n`,
      netIncome,
    );
    sellerMap.set(seller[i], {
      ...salesman,
      income: salesman.income + netIncome,
    });

    if (refer) {
      const referrer = sellerMap.get(refer);
      // fee ë”í•¨
      sellerMap.set(refer, { ...referrer, income: referrer.income + fee });
      console.log(`${i} refer ${refer} >> \n`, sellerMap.get(refer));
    }
  }

  // ì¶”ê°€ë¡œ ì²«ë²ˆì§¸, ë‘ë²ˆì§¸ ì‚¬ëžŒë“¤ ìˆ˜ìˆ˜ë£Œ ëº´ì¤˜ì•¼ë¨
  // ìžê¸° ì´ìµ ì „ì²´ì—ì„œ -10% í•´ì¤˜ì•¼ë¨
  // ê·¸ëƒ¥ objê°€ ì‰¬ìš¸ì§€ë„.

  // ìˆ˜ìˆ˜ë£Œ ë¹¼ê³ , fee ê³„ì† ë”í•´ì„œ income ë‚¨ê²Œ ë¨.
  console.log("before entries :", sellerMap);
  let sellerArr = [...sellerMap].map(([, obj]) => obj.income);

  return sellerArr;
}

let test1A = [
  "john",
  "mary",
  "edward",
  "sam",
  "emily",
  "jaimie",
  "tod",
  "young",
];
let test1B = ["-", "-", "mary", "edward", "mary", "mary", "jaimie", "edward"];
let test1C = ["young", "john", "tod", "emily", "mary"];
let test1D = [12, 4, 2, 5, 10];

console.log(`result : /n`, solution(test1A, test1B, test1C, test1D));
```
